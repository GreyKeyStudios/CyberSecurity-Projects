# Casefile 003: Malware/EDR Alert

## Alert Summary
**Alert Type:** Endpoint Detection Alert  
**Severity:** High  
**Source:** EDR / Antivirus  
**Date:** [Date]  
**Status:** Resolved

---

## Initial Triage

### Alert Details
- **Alert Name:** "Suspicious Process Execution"
- **Endpoint:** `WORKSTATION-01`
- **User:** `jdoe`
- **File:** `invoice.exe`
- **Hash:** `[SHA256]`
- **Detection:** Behavioral analysis + signature match
- **Time:** [Timestamp]

### Initial Assessment
- EDR detected suspicious process behavior
- File name suggests social engineering (invoice.exe)
- User executed file from email attachment
- Multiple detection engines flagged

**Priority:** High — Potential malware execution

---

## Investigation

### 1. File Analysis
**Tools Used:** VirusTotal, EDR console, File hash verification

**File Details:**
- **Name:** `invoice.exe`
- **Path:** `C:\Users\jdoe\Downloads\invoice.exe`
- **Size:** [Size] bytes
- **Hash (SHA256):** `[Hash]`
- **Hash (MD5):** `[Hash]`

**VirusTotal Results:**
- **Detection:** 52/70 engines flagged as malicious
- **File Type:** PE32 executable
- **First Seen:** [Recent date]
- **Tags:** Trojan, Downloader, Backdoor

### 2. Process Analysis
**Tools Used:** EDR console, Process Monitor

**Process Behavior:**
- Created network connections to suspicious IPs
- Attempted to modify registry keys
- Created files in `%TEMP%` directory
- Attempted to establish persistence

**Network Connections:**
- `[IP Address]:443` (HTTPS)
- `[IP Address]:80` (HTTP)
- **Geolocation:** [Country] (suspicious)

### 3. Endpoint Investigation
**Endpoint:** `WORKSTATION-01`

**Findings:**
- File executed by user `jdoe`
- Process terminated by EDR
- No data exfiltration detected
- Registry modifications blocked
- Network connections blocked

### 4. Scope Assessment
**Affected Systems:**
- `WORKSTATION-01` (isolated)

**User Impact:**
- Single user account
- No lateral movement detected
- No other endpoints affected

### 5. IOC Enrichment
**Indicators Found:**
- **File Hash:** `[SHA256]`
- **C2 IPs:** `[IP1]`, `[IP2]`
- **Domains:** `malicious-domain.com`
- **Registry Keys:** `[Registry Path]`

**Threat Intelligence:**
- All IOCs flagged as malicious
- Associated with known malware family: `[Family]`

---

## Findings

### Verdict: **MALWARE DETECTED AND CONTAINED**

### Indicators of Compromise (IOCs)
- **File Hash (SHA256):** `[Hash]`
- **File Hash (MD5):** `[Hash]`
- **C2 IPs:** `[IP1]`, `[IP2]`
- **C2 Domains:** `malicious-domain.com`
- **Registry Keys:** `[Registry Path]`
- **File Path:** `C:\Users\jdoe\Downloads\invoice.exe`

### Malware Characteristics
- **Type:** Trojan / Downloader
- **Family:** [Malware Family]
- **Behavior:** Network communication, registry modification, persistence attempts
- **Delivery:** Email attachment (phishing)

### Impact Assessment
- **Risk Level:** High
- **Actual Impact:** Low (contained by EDR)
- **Data at Risk:** None (blocked before exfiltration)
- **System Compromise:** None (process terminated)

---

## Resolution

### Immediate Actions Taken
1. ✅ Process terminated by EDR (automated)
2. ✅ File quarantined
3. ✅ Network connections blocked
4. ✅ Registry modifications prevented
5. ✅ Endpoint isolated for further investigation
6. ✅ Full system scan initiated
7. ✅ User account reviewed for compromise

### Containment Steps
- Endpoint isolated from network
- File hash added to blocklist
- C2 IPs blocked at firewall
- User account password reset (precautionary)
- Email source investigated

### Recommendations
- **Immediate:**
  - User security awareness training
  - Review email security gateway rules
  - Verify no other endpoints affected

- **Short-term:**
  - Strengthen email attachment filtering
  - Review EDR detection rules
  - Implement application whitelisting

- **Long-term:**
  - Regular security awareness training
  - Phishing simulation exercises
  - Enhanced email security controls

### Follow-up Actions
- ✅ Full endpoint scan completed (clean)
- ✅ User account reviewed (no compromise)
- ✅ Email source blocked
- ✅ IOCs added to threat intelligence feeds

---

## Ticket Notes

```
INCIDENT: 003-Malware-EDR-Alert
STATUS: Resolved
SEVERITY: High

SUMMARY:
EDR detected suspicious process execution. Malware (invoice.exe) 
executed from email attachment. Process terminated and contained.

INVESTIGATION:
- File: invoice.exe (SHA256: [Hash])
- VirusTotal: 52/70 engines flagged
- Behavior: Network connections, registry modification attempts
- C2 IPs: [IP1], [IP2] ([Country])
- Endpoint: WORKSTATION-01 (isolated)

IOCs:
- File Hash: [SHA256]
- C2 IPs: [IP1], [IP2]
- C2 Domain: malicious-domain.com
- Registry: [Registry Path]

ACTIONS:
- Process terminated by EDR
- File quarantined
- Network connections blocked
- Endpoint isolated
- Full scan completed (clean)
- User account reviewed (no compromise)

RESOLUTION:
Malware contained. No system compromise. Endpoint clean. 
IOCs blocked. User training scheduled.
```

---

## Lessons Learned
- EDR behavioral detection is critical for zero-day threats
- Email attachments remain a primary attack vector
- User education is essential for phishing prevention
- Automated containment prevented potential damage
- IOC enrichment helps understand threat scope

---

## References
- [Malware Analysis Project](../../Malware-Analysis/)
- [Threat Intelligence Project](../../Threat-Intelligence/)
- [Phishing Casefile](../001-Phishing-Triage/)
